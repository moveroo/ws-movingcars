---
import type { CollectionEntry } from 'astro:content';
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';

export async function getStaticPaths() {
  const routes = await getCollection('routes');

  return routes.map((route) => ({
    params: { slug: route.data.slugFs },
    props: { route },
  }));
}

const { route } = Astro.props as { route: CollectionEntry<'routes'> };

const metaDescription =
  route.data.metaDescription ??
  `Car transport from ${route.data.origin} to ${route.data.destination}. Professional interstate car shipping with full insurance. Get your free quote.`;

// Structured data for SEO
const schemaData = {
  '@context': 'https://schema.org',
  '@type': 'Service',
  name: route.data.title,
  description: metaDescription,
  provider: {
    '@type': 'LocalBusiness',
    name: 'Moving Cars',
  },
  areaServed: [
    { '@type': 'City', name: route.data.origin },
    { '@type': 'City', name: route.data.destination },
  ],
  serviceType: 'Interstate Car Transport',
};

// Machine-readable facts
const routeFacts = {
  service: 'Interstate Car Transport',
  route: `${route.data.origin} to ${route.data.destination}`,
  origin: route.data.origin,
  origin_state: route.data.originState,
  destination: route.data.destination,
  destination_state: route.data.destinationState,
  distance_km: route.data.distanceKm,
  transit_time: route.data.transitDays || '3-7 business days',
  price_range: route.data.priceRange,
  insurance_included: true,
  door_to_door: true,
};
---

<Layout title={route.data.title} description={metaDescription}>
  <script type="application/ld+json" set:html={JSON.stringify(schemaData)} />
  <script type="application/json" id="route-facts" set:html={JSON.stringify(routeFacts)} />

  <!-- Hero -->
  <section class="bg-gradient-to-br from-slate-900 to-slate-800 text-white py-16">
    <div class="container mx-auto px-4 text-center">
      <span
        class="inline-block px-4 py-1 mb-6 rounded-full bg-amber-500/20 text-amber-400 font-bold uppercase tracking-wider text-sm"
      >
        Interstate Car Transport
      </span>

      <h1 class="text-4xl md:text-5xl font-bold mb-4">
        {route.data.title}
      </h1>

      <p class="text-xl text-slate-300 mb-2">
        {route.data.origin}, {route.data.originState} → {route.data.destination}, {
          route.data.destinationState
        }
      </p>

      {
        route.data.distanceKm && (
          <p class="text-slate-400 mb-2">Distance: {route.data.distanceKm.toLocaleString()} km</p>
        )
      }

      {
        route.data.transitDays && (
          <p class="text-slate-400 mb-8">
            {route.data.transitDays.includes('10') || route.data.transitDays.includes('14') ? (
              <span>Long-distance route. Typical transit: {route.data.transitDays}.</span>
            ) : (
              <span>Typical transit: {route.data.transitDays}</span>
            )}
          </p>
        )
      }

      {/* State-specific advisory */}
      {
        route.data.destinationState === 'WA' && (
          <div class="mb-8 p-4 bg-white/10 rounded-lg text-sm text-slate-200 max-w-xl mx-auto">
            <strong>Heading to Western Australia?</strong> We handle all biosecurity requirements
            for your vehicle.
          </div>
        )
      }
      {
        route.data.destinationState === 'TAS' && (
          <div class="mb-8 p-4 bg-white/10 rounded-lg text-sm text-slate-200 max-w-xl mx-auto">
            <strong>Bass Strait Crossing:</strong> Ferry costs are included in your quote. No hidden
            fees.
          </div>
        )
      }

      {
        route.data.priceRange && (
          <p class="text-2xl font-bold text-amber-400 mb-8">From {route.data.priceRange}</p>
        )
      }

      <a
        href="/quote/"
        class="inline-block bg-amber-500 hover:bg-amber-600 text-slate-900 font-bold py-4 px-10 rounded-lg text-lg transition-colors"
      >
        Get a Free Quote
      </a>
    </div>
  </section>

  <!-- Breadcrumb -->
  <nav class="py-4 bg-slate-100">
    <div class="container mx-auto px-4">
      <div class="flex items-center gap-2 text-sm text-slate-600">
        <a href="/" class="hover:text-blue-600">Home</a>
        <span>›</span>
        <a href="/routes/" class="hover:text-blue-600">Routes</a>
        <span>›</span>
        <span class="text-slate-900">{route.data.origin} to {route.data.destination}</span>
      </div>
    </div>
  </nav>

  <!-- Content -->
  <section class="py-12 bg-white">
    <div class="container mx-auto px-4">
      <div class="max-w-3xl mx-auto prose prose-lg">
        <h2>Car Transport from {route.data.origin} to {route.data.destination}</h2>
        <p>
          Moving Cars provides professional, reliable car transport services between {
            route.data.origin
          } and {route.data.destination}. Whether you're relocating, buying a car interstate, or
          need to move a fleet, we've got you covered.
        </p>

        <h3>What's Included</h3>
        <ul>
          <li>Full transit insurance</li>
          <li>Door-to-door or depot-to-depot options</li>
          <li>Real-time tracking</li>
          <li>No hidden fees</li>
        </ul>

        <h3>Transit Time</h3>
        <p>
          The typical transit time for {route.data.origin} to {route.data.destination} is <strong
            >{route.data.transitDays || '3-7 business days'}</strong
          >, depending on carrier availability and your specific pickup/delivery locations.
        </p>
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="py-12 bg-slate-900 text-white">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-3xl font-bold mb-4">Ready to Transport Your Car?</h2>
      <p class="text-slate-300 mb-8">Get a free, no-obligation quote in under 2 minutes.</p>
      <a
        href="/quote/"
        class="inline-block bg-amber-500 hover:bg-amber-600 text-slate-900 font-bold py-4 px-10 rounded-lg text-lg transition-colors"
      >
        Get a Free Quote
      </a>
    </div>
  </section>
</Layout>
